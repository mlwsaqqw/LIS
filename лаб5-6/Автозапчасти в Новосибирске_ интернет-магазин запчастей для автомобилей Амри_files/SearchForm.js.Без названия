(self.webpackChunkwar_lib_6=self.webpackChunkwar_lib_6||[]).push([[2398],{68634:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(59713),s=n.n(r),i=n(34575),a=n.n(i),c=n(93913),u=n.n(c),o=n(87757),h=n.n(o),l=n(48926),f=n.n(l),d=function(){function e(t){a()(this,e),this.value=t}return u()(e,[{key:"ap",value:function(e){return e}},{key:"bimap",value:function(t){return new e(t(this.value))}},{key:"chain",value:function(){return this}},{key:"map",value:function(){return this}},{key:"either",value:function(e){return e(this.value)}}]),e}(),p=function(){function e(t){a()(this,e),this.value=t}return u()(e,[{key:"ap",value:function(e){return this.chain((function(t){return e.map(t)}))}},{key:"bimap",value:function(t,n){return new e(n(this.value))}},{key:"chain",value:function(e){return e(this.value)}},{key:"map",value:function(t){return new e(t(this.value))}},{key:"either",value:function(e,t){return t(this.value)}}]),e}();function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){var e=f()(h().mark((function e(t,n){var r,s,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.json();case 3:s=e.sent,i=s.errorMessage,r=i||n,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r=t.statusText;case 11:return(a=new Error(r)).status=t.status,a.name="ApiError",e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/v2/",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a()(this,e),this.domain=t,this.settings=n,this.language=n.language||window.warLng}var t;return u()(e,[{key:"makeRequest",value:(t=f()(h().mark((function e(t){var n,r,s,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.path,r=t.options,s=void 0===r?{}:r,i=this.settings.messages,!this.settings.isDemoMode||!s.method){e.next=4;break}return e.abrupt("return",new d(new Error(null==i?void 0:i.demoError)));case 4:return e.prev=4,e.next=7,fetch(this.domain+n,m({credentials:"include",headers:{warLng:this.language}},s));case 7:a=e.sent,e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",new d(e.t0));case 13:if(a.redirected&&window.location.replace(a.url),!a.ok){e.next=20;break}return e.t1=p,e.next=18,a.json();case 18:return e.t2=e.sent,e.abrupt("return",new e.t1(e.t2));case 20:return e.t3=d,e.next=23,y(a,null==i?void 0:i.defaultErrorMsg);case 23:return e.t4=e.sent,e.abrupt("return",new e.t3(e.t4));case 25:case"end":return e.stop()}}),e,this,[[4,10]])}))),function(e){return t.apply(this,arguments)})},{key:"post",value:function(e,t){var n=t;return t instanceof FormData||(n=JSON.stringify(t)),this.makeRequest({path:e,options:{method:"POST",body:n}})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.makeRequest({path:e,options:t})}},{key:"patch",value:function(e,t){return this.makeRequest({path:e,options:{method:"PATCH",body:JSON.stringify(t)}})}},{key:"delete",value:function(e,t){return this.makeRequest({path:e,options:{method:"DELETE",body:JSON.stringify(t)}})}},{key:"setLanguage",value:function(e){this.language=e}},{key:"setSettings",value:function(e){return this.settings=e,this}}]),e}()},59065:function(e,t){"use strict";t.Z="webAnalytics."},3018:function(e,t,n){"use strict";n.d(t,{rd:function(){return r},OU:function(){return s},cz:function(){return i},RY:function(){return a}});var r="search.initResults",s="search.startRequest",i="search.successRequest",a="search.pushSearchForm"},22121:function(e,t,n){"use strict";n.d(t,{v:function(){return r},y:function(){return s}});var r="searchWithFilters.initApp",s="searchWithFilters.showSelectProducerModal"},9744:function(e,t,n){"use strict";n.d(t,{JU:function(){return s},DP:function(){return i},f1:function(){return a},L3:function(){return c},xp:function(){return u},tA:function(){return o},Wk:function(){return h},iG:function(){return l},i4:function(){return f},cp:function(){return d}});var r=n(59065),s="".concat(r.Z,"auth.FormOpen"),i="".concat(r.Z,"auth.Success"),a="".concat(r.Z,"registration.BtnRegister"),c=("".concat(r.Z,"registration.Success"),"".concat(r.Z,"search.pushSearchForm")),u="".concat(r.Z,"search.searchByLink"),o="".concat(r.Z,"search.successRequest"),h="".concat(r.Z,"basket.BtnAddToBasket"),l="".concat(r.Z,"basket.BtnSaveOrder"),f="".concat(r.Z,"order.BtnMakeOrder"),d="".concat(r.Z,"vinrequest.Success");"".concat(r.Z,"order.Success")},45832:function(e,t,n){"use strict";var r=n(63038),s=n.n(r),i=n(87757),a=n.n(i),c=n(48926),u=n.n(c),o=n(319),h=n.n(o),l=n(59713),f=n.n(l),d=n(34575),p=n.n(d),v=n(93913),m=n.n(v),y=n(3018),S=n(22121),b=n(9744),g=n(43572),k=n(65951),w=n(26216),E=function(){function e(t,n){var r=this,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;p()(this,e),this.instance=new w.Z(s),this.instance.init({container:n,input:t}),this.input=t,window.EventsBus.on(y.cz,(function(){r.instance.enableAutocomplete()})),window.EventsBus.on(y.OU,(function(){r.instance.disableAutocomplete()})),i&&window.EventsBus.on(S.y,(function(){r.instance.disableAutocomplete()}))}return m()(e,[{key:"onSelect",value:function(e){var t=this,n=w.Z.EVENTS.START_SEARCH;this.instance.on(n,(function(n){var r=n.article,s=void 0===r?"":r;t.input.value=s,e(n)}))}}]),e}(),R=n(89315),O=function(){function e(t){var n=t.breadcrumbsSelector,r=void 0===n?"":n,s=t.breadcrumbsListSelector,i=void 0===s?"":s,a=t.searchBreadcrumbs,c=void 0===a?"":a;p()(this,e),this.breadcrumbsSelector=r,this.breadcrumbsListSelector=i,this.searchBreadcrumbs=c}return m()(e,[{key:"setSearchBreadcrumbs",value:function(){var e=document.querySelector(this.breadcrumbsSelector);if(e){var t=document.querySelector(this.breadcrumbsListSelector);t&&(t.innerHTML=this.searchBreadcrumbs,e.removeAttribute("hidden"))}}},{key:"create",value:function(e,t){if(!document.getElementById(t)){this.searchBreadcrumbs&&this.setSearchBreadcrumbs();var n=document.querySelector(e);if(!n)throw new Error("Render container not found!");(0,R.Z)(n);var r=document.createElement("div");r.id=t,n.innerHTML="",n.appendChild(r)}}}]),e}();function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I={searchBundleUrl:"/_syslib/modules/SearchWithFilters.js",searchFormSelector:"[name=search_code]",articleSelector:"[name=article]",useAutocompleteSearch:0,historyItems:[],autocompleteSearchId:"vue-search-autocomplete",renderContainerSelector:"#content_inner",contentSelector:"#content",breadcrumbsSelector:"#breadcrumbs-line",breadcrumbsListSelector:"#breadcrumbs-list",searchBreadcrumbs:"",mainBlockWrapperId:"main_inner_wrapper",moduleSearchConfigs:null,searchFormInputClass:".search-form__input",form:{focusClass:"search-form_focus"},searchUrl:"/search.html"},P=function(){function e(t){var n=this;p()(this,e),this.props=A(A({},I),t);var r=this.props,s=r.moduleSearchConfigs,i=r.historyItems,a=r.mainBlockWrapperId,c=r.searchBundleUrl,u=r.messages,o=r.initSearchParameters,h=r.webInfoModalData;this.messages=u,(0,g.Z)(c).then((function(){n.moduleSearch=new window.SearchWithFilters(A(A({},s),{},{webInfoModalData:h,elementId:a})),o&&n.search(A(A({},o),{},{initiallyRendered:!0}))})),this.init(),this.setLinkHandlers(),this.initHistory(i)}var t;return m()(e,[{key:"init",value:function(){var e=this,t=this.props,n=t.searchFormSelector,r=t.articleSelector,s=t.useAutocompleteSearch,i=t.autocompleteSearchId,a=t.searchFormInputClass,c=t.showSelectProducer;if(this.searchResultContainer=new O(this.props),this.searchForm=document.querySelector(n),this.searchFormInput=document.querySelector(a),!this.searchForm)throw new Error("Search form not found by selector: ".concat(n));if(this.searchForm.addEventListener("submit",(function(t){t.preventDefault(),e.pushSearchForm()})),this.articleField=this.searchForm.querySelector(r),this.articleField){if(this.addArticleValidators(),s){var u=document.getElementById(i);if(u){this.autocompleteLiveSearch=new E(this.articleField,u,!1,c),this.autocompleteLiveSearch.onSelect((function(t){var n=t.article,r=t.brand,s=new Map;s.set("brand",r),s.set("article",n),e.pushSearchForm(s)}))}}window.EventsBus.on(S.v,(function(){var t=e.props,n=t.renderContainerSelector,r=t.mainBlockWrapperId;e.searchResultContainer.create(n,r)}))}}},{key:"setLinkHandlers",value:function(){var e=this,t=this.props.searchUrl;h()(document.querySelectorAll('[href*="'.concat(t,'"]:not([target=_blank]):not([data-lang-switcher])'))).forEach((function(t){t.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation(),e.searchByUrl(t.href)}))})),h()(document.querySelectorAll('[data-href*="'.concat(t,'"]'))).forEach((function(t){t.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation(),e.searchByUrl(t.getAttribute("data-href"))}))}))}},{key:"addArticleValidators",value:function(){var e=this.articleField,t=this.searchForm,n=this.props.form.focusClass;e.addEventListener("focus",(function(){t.classList.add(n)})),e.addEventListener("blur",(function(){t.classList.remove(n)}))}},{key:"initHistory",value:function(e){var t=this;this.historyModule=new k.Z({items:e,clickUrlFunction:function(e){t.searchByUrl(e)}})}},{key:"pushSearchForm",value:function(e){var t=this.articleField,n=this.searchForm;if(t.value){var r=new FormData(n),s={};r.forEach((function(e,t){s[t]=e})),e&&e.forEach((function(e,t){s[t]=e})),window.EventsBus.emit(y.RY),window.EventsBus.emit(b.L3),this.search(s)}else t.focus()}},{key:"search",value:(t=u()(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.historyModule&&(r=null===(n=t.article)||void 0===n?void 0:n.toUpperCase(),this.historyModule.addItemByArticle(r,"".concat(this.props.searchUrl,"?article=").concat(r))),this.blurSearchInput(),e.next=4,this.moduleSearch.search(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"searchByUrl",value:function(e){window.EventsBus.emit(b.xp);var t=e.split("?"),n=s()(t,2)[1],r=new URLSearchParams(n),i={};r.forEach((function(e,t){i[t]=e})),this.articleField&&(this.articleField.value=i.article),this.search(i)}},{key:"blurSearchInput",value:function(){this.searchFormInput.blur()}}],[{key:"changeLangSwitchersHREF",value:function(){var e="change-lng";h()(document.querySelectorAll("[data-lang-switcher]")).forEach((function(t){var n=new URL(t.href).searchParams.get(e),r=new URL(window.location.href);r.searchParams.set(e,n),t.href=r.href}))}}]),e}();window.SearchForm=P},89315:function(e,t,n){"use strict";function r(e){var t=e.parentElement,n="content_type_main",r="container",s=document.getElementById("content").classList;s.contains(n)&&s.remove(n),t.closest(".".concat(r))||t.classList.add(r)}n.d(t,{Z:function(){return r}})},65951:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(34575),s=n.n(r),i=n(93913),a=n.n(i),c=n(70538),u=function(){function e(t){var n=t.items,r=t.clickUrlFunction,i=void 0!==r&&r;s()(this,e),this.initCheck=!1,this.init(n),this.clickUrlFunction=i}return a()(e,[{key:"init",value:function(e){var t=document.getElementById("search-history-template"),n=this.clickUrl.bind(this);if(!t)throw new Error("Unsuccessful initialization of SearchHistory.js");this.component=new c.default({el:t,name:"SearchHistoryApp",data:function(){return{items:e,visibleDrop:!0}},methods:{clickUrl:function(e){n(e)},resetVisibleDrop:function(){var e=this;this.visibleDrop=!1,setTimeout((function(){e.visibleDrop=!0}),100)}}}),this.initCheck=!0}},{key:"addItemByArticle",value:function(e,t){this.component.items.find((function(t){return t.sse_search_number===e}))||this.component.items.unshift({sse_search_number:e,url:t})}},{key:"setItems",value:function(e){this.initCheck&&(this.component.items=e)}},{key:"clickUrl",value:function(e){this.clickUrlFunction&&(this.component.resetVisibleDrop(),this.clickUrlFunction(e))}},{key:"getHistory",value:function(){return this.component.items}}]),e}()},43572:function(e,t,n){"use strict";function r(e){return new Promise((function(t,n){if(e){var r=document.getElementsByTagName("script")[0],s=document.createElement("script");s.type="text/javascript",s.src=e,s.async=!0,s.onload=function(){t()};try{r?r.parentNode.insertBefore(s,r):document.body.parentNode.insertBefore(s,document.body)}catch(e){throw n(),new Error(e)}}}))}n.d(t,{Z:function(){return r}})},26216:function(e,t,n){"use strict";n.d(t,{Z:function(){return E}});var r=n(59713),s=n.n(r),i=n(87757),a=n.n(i),c=n(48926),u=n.n(c),o=n(34575),h=n.n(o),l=n(93913),f=n.n(l),d=n(70538),p=n(39914),v=n(16152),m=n(68634),y={RESPONCE_WAITING:"RESPONCE_WAITING",RESPONSE_SUCCESSFUL:"RESPONSE_SUCCESSFUL",RESPONSE_VIEW_CANCEL:"RESPONSE_VIEW_CANCEL"},S=function(){function e(){h()(this,e),this.requests={}}return f()(e,[{key:"startRequest",value:function(e){this.AddRequest(e,{status:y.RESPONCE_WAITING,timeStart:Date.now()})}},{key:"removeAllRequests",value:function(){this.requests={}}},{key:"cancelAllRequests",value:function(){var e=this;Object.keys(this.requests).forEach((function(t){e.setRequestStatus(t,y.RESPONSE_VIEW_CANCEL)}))}},{key:"removeRequest",value:function(e){delete this.requests[e]}},{key:"AddRequest",value:function(e,t){this.requests[e]=t}},{key:"getRequestStatus",value:function(e){var t=this.requests[e];return t?t.status:""}},{key:"setRequestStatus",value:function(e,t){var n=this.requests[e];n&&(n.status=t)}},{key:"hasRequest",value:function(e){return Object.prototype.hasOwnProperty.call(this.requests,e)}}],[{key:"statuses",get:function(){return y}}]),e}(),b=n(81605),g=function(){function e(){h()(this,e),this.state={},this.maxResults=10}return f()(e,[{key:"addRequestData",value:function(e,t){var n=(0,b.Z)(e);this.state[n]={key:n,time:Date.now(),data:t},this.cleanState()}},{key:"getRequestData",value:function(e){var t=(0,b.Z)(e);return this.hasRequesData(t)?this.state[t].data:{}}},{key:"hasRequesData",value:function(e){var t=(0,b.Z)(e);return Object.prototype.hasOwnProperty.call(this.state,t)}},{key:"cleanState",value:function(){var e=this;if(Object.keys(this.state).length>this.maxResults){var t=Object.keys(this.state),n=this.state;if(t&&n){var r=t.sort((function(e,t){var r=n[e],s=n[t];return r.time<s.time?1:r.time>s.time?-1:0})).slice(this.maxResults);r&&r.forEach((function(t){delete e.state[t]}))}}}}]),e}();function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}d.default.directive("on-click-outside",p.directive);var E=function(){function e(t){h()(this,e),this.callbacks={},this.disabled=!1,this.showMoreItem=t}return f()(e,[{key:"init",value:function(e){var t=e.container,n=e.input;if(t&&n&&void 0!==d.default)if(n){var r=!1,s=t.getAttribute("data-api-url");s&&(r=s),this.requestQueue=new S,this.state=new g,this.articleInput=n,this.appAutocomplete=t,this.urlApi=r,this.vueSearch=this.initVue()}else new Error("Article input not found!")}},{key:"disableAutocomplete",value:function(){this.disabled=!0,this.requestQueue.cancelAllRequests(),this.vueSearch&&this.vueSearch.hideResults()}},{key:"enableAutocomplete",value:function(){this.disabled=!1}},{key:"on",value:function(e,t){this.callbacks[e]={func:t}}},{key:"fire",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.callbacks;n&&n[e]&&n[e].func(t)}},{key:"initVue",value:function(){var t=this,n="";return t.articleInput&&(n=t.articleInput.value),new d.default({el:t.appAutocomplete,name:"VueSearchAutocomplete",data:function(){return{showResults:!1,searchString:n,loading:!1,searchResultsString:"",searchResults:[],searchResultsProcessed:[],url:"/search/sphinx/"}},computed:{filteredResults:function(){return t.showMoreItem?this.searchResultsProcessed:this.searchResultsProcessed.filter((function(e){return"more"!==e.source}))}},watch:{searchString:function(){this.inputChangeEventDebounce()}},mounted:function(){var n=this;t.articleInput&&(t.articleInput.addEventListener("input",(function(){n.searchString=t.articleInput.value})),t.articleInput.addEventListener("click",(function(e){n.searchString=t.articleInput.value,e.target===t.articleInput&&n.getAutocomplete()}))),t.urlApi&&(this.url=t.urlApi),this.api=new m.Z(this.url),this.$el.classList.add("inited"),this.$el.style.display="",this.inputChangeEventDebounce=(0,v.Z)((function(){n.getAutocomplete(n.searchString)}),300,{leading:!1}),t.fire(e.EVENTS.AFTER_INIT)},methods:{getAutocomplete:function(){this.searchString.length>2?this.getAutocompleteHandler(this.searchString):this.cleanData()},cleanData:function(){this.searchResults=[],this.searchResultsProcessed=[],this.hideResults()},getAutocompleteHandler:function(e){t.disabled?this.showResults=!1:this.searchResultsString===this.searchString&&Object.keys(this.searchResults).length>0?this.showResults=!0:t.state.hasRequesData(e)?(this.setSearchResults(e,t.state.getRequestData(e)),this.showResults=!0):this.fetchData(e)},setSearchResults:function(e,t){this.searchResultsString=e,this.searchResults=t,this.searchResultsProcessed=this.dataProcessedHandler(this.searchResults)},fetchData:function(e){var n=this;return u()(a().mark((function r(){var s;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.requestQueue.hasRequest(e)){r.next=2;break}return r.abrupt("return");case 2:return t.requestQueue.startRequest(e),n.updateLoadingStatus(),s="?term=".concat(encodeURIComponent(e)),r.next=7,n.api.get(s);case 7:r.sent.either((function(r){throw t.requestQueue.removeRequest(e),n.updateLoadingStatus(),r}),(function(t){n.requestSucessfulHandler(t,e)}));case 9:case"end":return r.stop()}}),r)})))()},requestSucessfulHandler:function(e,n){this.dataHandler(e,n),t.requestQueue.getRequestStatus(n)!==S.statuses.RESPONSE_VIEW_CANCEL&&this.getAutocompleteHandler(n),t.requestQueue.removeRequest(n),this.updateLoadingStatus()},dataHandler:function(e,n){var r=1,s=[];e.forEach((function(e){s[r]=e,s[r].indexId=r,r+=1})),t.state.addRequestData(n,e)},dataProcessedHandler:function(e){var t=w({},e),n=new RegExp(this.searchString,"gi"),r=[];return Object.keys(t).forEach((function(e){var s=t[e],i=w({},s);Object.keys(i).forEach((function(e){n.test(i[e])&&(i[e]=s[e].replace(n,'<span class="marker">$&</span>'))})),r.push(i)})),r},setLoading:function(e){this.loading=e},updateLoadingStatus:function(){t.requestQueue.hasRequest(this.searchString)&&t.requestQueue.getRequestStatus(this.searchString)===S.statuses.RESPONCE_WAITING?this.loading=!0:this.loading=!1},clickOutside:function(){document.activeElement!==t.articleInput&&this.hideResults()},hideResults:function(){this.setLoading(!1),this.showResults=!1},ajaxSearch:function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.hideResults(),!1!==n&&this.searchResults){var r=this.searchResults.filter((function(e){return e.indexId===n}));if(r[0]){var s=r[0];t.fire(e.EVENTS.START_SEARCH,{article:s.code,brand:s.prd_name,source:s.source})}}}}})}}],[{key:"EVENTS",get:function(){return{AFTER_INIT:"AFTER_INIT",START_SEARCH:"START_SEARCH"}}}]),e}()}},0,[[45832,97,1932]]]);